# üê≥ –ó–∞–ø—É—Å–∫ –Ω–∞ BotHost —Å Docker

## üìã –ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ Dockerfile

```dockerfile
# Optimized multi-stage build –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–∞
- Python 3.11-slim (–±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑)
- All dependencies from requirements.txt
- Flask –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –Ω–∞ –ø–æ—Ä—Ç—É 5000
- Telegram bot polling
- Health check –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
```

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ BotHost

### –®–∞–≥ 1: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å—ë –≥–æ—Ç–æ–≤–æ

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤
ls -la | grep -E "(Dockerfile|.dockerignore|requirements.txt|main.py|.env)"

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
# ‚úì Dockerfile
# ‚úì .dockerignore
# ‚úì requirements.txt
# ‚úì main.py
# ‚úì .env (–∏–ª–∏ Environment Variables –Ω–∞ BotHost)
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env

```bash
cat .env | head -5

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# BOT_TOKEN=8039974939:AAF...
# ADMIN_IDS=12345
# ADMIN_USERNAME=admin
# ENVIRONMENT=production (–∏–ª–∏ development)
```

### –®–∞–≥ 3: Git Push

```bash
git add .
git commit -m "Add Docker support for BotHost deployment"
git push origin main
```

### –®–∞–≥ 4: –ù–∞ BotHost

**–í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å BotHost
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. BotHost **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç Dockerfile**
4. –ù–∞–∂–º–∏—Ç–µ **"Deploy"** –∏–ª–∏ **"Rebuild"**
5. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏ (5-10 –º–∏–Ω—É—Ç)

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å (–µ—Å–ª–∏ –ê –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)**

```bash
# –ù–∞ BotHost
git pull origin main
docker build -t kanaltexservice:latest .
docker run -d \
  -p 5000:5000 \
  -e BOT_TOKEN="your_token" \
  -e ADMIN_IDS="your_id" \
  -e ENVIRONMENT="production" \
  kanaltexservice:latest
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è BotHost

### Environment Variables (–≤ –ø–∞–Ω–µ–ª–∏ BotHost)

```
Key: BOT_TOKEN
Value: 8039974939:AAFznh79U...

Key: ADMIN_IDS
Value: 12345, 67890

Key: ADMIN_USERNAME
Value: admin

Key: ADMIN_PASSWORD_HASH
Value: $2b$12$R9h/cIPz0gi.URNNX3kh2OPST9/PgBkqquzi.Ee3XEALtW5RhHKNa

Key: ENVIRONMENT
Value: production

Key: PORT
Value: 5000
```

### –ü–æ—Ä—Ç

BotHost **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç –ø–æ—Ä—Ç 5000** –Ω–∞—Ä—É–∂—É. –í–∞—à–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
```
https://your-bothost-project.bothost.ru:5000
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Dockerfile

### –®–∞–≥ 1: Builder Stage (—Å–±–æ—Ä–∫–∞)
```dockerfile
FROM python:3.11-slim as builder
  ‚îî‚îÄ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç gcc –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
  ‚îî‚îÄ –ö–æ–ø–∏—Ä—É–µ—Ç requirements.txt
  ‚îî‚îÄ pip install ‚Üí /root/.local
```

### –®–∞–≥ 2: Final Stage (–ø—Ä–æ–¥–∞–∫—à–Ω)
```dockerfile
FROM python:3.11-slim
  ‚îî‚îÄ –ö–æ–ø–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
  ‚îî‚îÄ –ö–æ–ø–∏—Ä—É–µ—Ç –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  ‚îî‚îÄ –°–æ–∑–¥–∞—ë—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –ª–æ–≥–æ–≤/–¥–∞–Ω–Ω—ã—Ö
  ‚îî‚îÄ Health check
  ‚îî‚îÄ Expose 5000
  ‚îî‚îÄ CMD: python main.py
```

### –†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞

- **Builder stage**: ~500 MB (–≤—ã–±—Ä–æ—Å–∏—Ç—Å—è)
- **Final image**: ~300-400 MB (–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è)
- **–ü–æ—Å–ª–µ push**: ~150-200 MB (—Å–∂–∏–º–∞–µ—Ç—Å—è)

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–í –ø–∞–Ω–µ–ª–∏ BotHost ‚Üí –õ–æ–≥–∏ ‚Üí –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```
üìÑ Loading .env from project root: /app/.env
‚úì BOT_TOKEN loaded (starts with: 8039974939:AA...)
‚úì Loaded 1 Telegram admin(s): [12345]
‚úì Configuration loaded: PRODUCTION mode
‚úì Flask app created successfully
üöÄ Ready to start!
Starting Telegram bot polling...
```

### 2. Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```bash
# –ê–¥—Ä–µ—Å
https://your-project.bothost.ru:5000

# –õ–æ–≥–∏–Ω
Username: admin
Password: 12345 (–∏–ª–∏ –≤–∞—à –ø–∞—Ä–æ–ª—å)
```

### 3. Telegram –±–æ—Ç

- –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
- –ï—Å–ª–∏ –≤—ã –≤ ADMIN_IDS ‚Üí –ø–æ—è–≤–∏—Ç—Å—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### 4. Health Check

```bash
# BotHost –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —ç—Ç–æ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
curl http://localhost:5000/health

# –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç–∏—Ç —Å—Ç–∞—Ç—É—Å 200 ‚Üí –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–¥–æ—Ä–æ–≤
```

---

## üêõ –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|----------|
| "Docker –Ω–µ –Ω–∞–π–¥–µ–Ω" | BotHost –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Docker. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Environment Variables –≤ –ø–∞–Ω–µ–ª–∏ |
| "Port 5000 –∑–∞–Ω—è—Ç" | BotHost –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç –Ω–∞ —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç |
| "BOT_TOKEN –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è" | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ Environment Variables |
| "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è" | –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏. –û–±—ã—á–Ω–æ - –æ—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω |
| "–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞" | –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Flask –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (`Flask app created successfully` –≤ –ª–æ–≥–∞—Ö) |

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### .env —Ñ–∞–π–ª
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore` (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
- ‚úÖ –ú–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –ù–∞ BotHost –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Environment Variables

### Dockerfile
- ‚úÖ –ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∏–∫–∞–∫–∏—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `python:3.11-slim` (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π, –±–µ–∑ –ª–∏—à–Ω–∏—Ö —É—Ç–∏–ª–∏—Ç)
- ‚úÖ Health check –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –°–±–æ—Ä–∫–∞
- ‚úÖ Multi-stage build (–∏—Å–∫–ª—é—á–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∫–∏ –∏–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞)
- ‚úÖ `.dockerignore` –∏—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã

---

## üìà –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π

```bash
# –ù–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ

# 1. –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
docker build -t kanaltexservice:test .

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –≤–∞—à–∏–º .env
docker run -d \
  -p 5000:5000 \
  --env-file .env \
  kanaltexservice:test

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ
curl http://localhost:5000/health

# 4. –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker logs -f <container_id>

# 5. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ
docker stop <container_id>
```

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∑–∞ 30 —Å–µ–∫—É–Ω–¥

1. **–£–±–µ–¥–∏—Ç–µ—Å—å:**
   ```bash
   git status  # –≤—Å–µ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ
   cat .env | grep BOT_TOKEN  # —Ç–æ–∫–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
   ```

2. **Push:**
   ```bash
   git add .
   git commit -m "Deploy with Docker"
   git push origin main
   ```

3. **BotHost:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å ‚Üí –Ω–∞–π–¥–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
   - –ù–∞–∂–º–∏—Ç–µ **Deploy** –∏–ª–∏ **Rebuild**
   - –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

4. **–¢–µ—Å—Ç:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ `https://your-project.bothost.ru:5000`
   - –õ–æ–≥–∏–Ω–∏—Ç–µ—Å—å: admin / 12345
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É

**–ì–æ—Ç–æ–≤–æ! ‚ú®**

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- `Dockerfile` ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è BotHost
- `.dockerignore` ‚Äî –∏—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
- `requirements.txt` ‚Äî –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `main.py` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç `.env` –∏–∑ –∫–æ—Ä–Ω—è
- `ADMIN_CONFIG.md` ‚Äî –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–º–æ—Ç—Ä–∏—Ç–µ `TROUBLESHOOTING.md` –∏–ª–∏ `ADMIN_CONFIG.md`
